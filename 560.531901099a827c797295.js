"use strict";(self.webpackChunkUlbiTV_frontend=self.webpackChunkUlbiTV_frontend||[]).push([[560],{11:function(e,a,t){t.d(a,{I:function(){return c}});var r=t(7294),s=t(3007),l={inputWrapper:"yiPASP1v",placeholder:"emAQQ85i",input:"LVdIPwcx",caretWrapper:"y1GiFC_L",caret:"lqMFGBuL",blink:"M7n8faAU",readonly:"fTN1PnWu"},i=t(5893);const c=(0,r.memo)((e=>{let{className:a,value:t="",onChange:c,type:n="text",placeholder:o,autoFocus:d,readonly:g,...u}=e;const[p,h]=(0,r.useState)(!1),[v,m]=(0,r.useState)(0),x=p&&!g,y=(0,r.useRef)(null);(0,r.useEffect)((()=>{d&&(h(!0),y.current?.focus())}),[d]);const j={[l.redonly]:g};return(0,i.jsxs)("div",{className:(0,s.A)(l.inputWrapper,j,[a]),children:[o&&(0,i.jsx)("div",{className:l.placeholder,children:`${o}>`}),(0,i.jsxs)("div",{className:l.caretWrapper,children:[(0,i.jsx)("input",{type:n,value:t,onChange:e=>{if(t?.toString().length>e?.target?.value?.length)return c?.(e.target.value),void m(e?.target?.selectionStart||0);c?.(e.target.value),m(e.target.value.length)},className:l.input,onFocus:()=>{h(!0)},onBlur:()=>{h(!1)},onSelect:e=>{m(e?.target?.selectionStart||0)},ref:y,readOnly:g,...u}),x&&(0,i.jsx)("span",{className:l.caret,style:{left:9*v+"px"}})]})]})}))},8283:function(e,a,t){t.r(a),t.d(a,{default:function(){return Q}});var r=t(1233),s=t(5401),l=t(9970),i=t(7294),c=t(9655),n=t(4268),o=t(3184);const d=e=>e.articlesPage?.isLoading||!1,g=e=>e.articlesPage?.error,u=e=>e.articlesPage?.view||o.GA.SMALL,p=e=>e.articlesPage?.page||1,h=e=>e.articlesPage?.hasMore,v=e=>e.articlesPage?.order??"asc",m=e=>e.articlesPage?.sort??o.$B.CREATED,x=e=>e.articlesPage?.search??"",y=e=>e.articlesPage?.type??o.Iq.ALL;const j=(0,n.hg)("articlesPage/fetchArticlesList",(async(e,a)=>{const{extra:t,rejectWithValue:r,getState:s,dispatch:l}=a,i=p(s()),c=(n=s(),n.articlesPage?.limit||9);var n;const d=m(s()),g=v(s()),u=x(s()),h=y(s());try{j={sort:d,order:g,search:u,type:h},window.history.pushState(null,"",function(e){const a=new URLSearchParams(window.location.search);return Object.entries(e).forEach((e=>{let[t,r]=e;void 0!==r&&a.set(t,r)})),`?${a.toString()}`}(j));const e=await t.api.get("/articles",{params:{_expand:"user",_limit:c,_page:i,_sort:d,_order:g,q:u,type:h===o.Iq.ALL?void 0:h}});if(!e.data)throw new Error;return e}catch(e){return r("error")}var j}));var w=t(1283);const S=(0,n.HF)({selectId:e=>e.id}),L=S.getSelectors((e=>e.articlesPage||S.getInitialState())),f=(0,n.oM)({name:"articlesPageSlice",initialState:S.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{},view:o.GA.SMALL,page:1,limit:8,hasMore:!0,sort:o.$B.CREATED,order:"asc",search:"",type:o.Iq.ALL,_inited:!1}),reducers:{setView:(e,a)=>{e.view=a.payload,localStorage.setItem(w.j,a.payload)},setPage:(e,a)=>{e.page=a.payload},setHasMore:(e,a)=>{e.hasMore=a.payload},setOrder:(e,a)=>{e.order=a.payload},setSearch:(e,a)=>{e.search=a.payload},setSort:(e,a)=>{e.sort=a.payload},setType:(e,a)=>{e.type=a.payload},initState:e=>{const a=e.view=localStorage.getItem(w.j);e.view=a,e.limit=a===o.GA.BIG?4:8,e._inited=!0}},extraReducers:e=>{e.addCase(j.pending,((e,a)=>{e.error=void 0,e.isLoading=!0,a.meta.arg.replace&&S.removeAll(e)})).addCase(j.fulfilled,((e,a)=>{Number(a.payload.headers["x-total-count"])<e.page*e.limit&&(e.hasMore=!1),e.isLoading=!1,a.meta.arg.replace?S.setAll(e,a.payload.data):S.addMany(e,a.payload.data)})).addCase(j.rejected,((e,a)=>{e.error=a.payload,e.isLoading=!1}))}}),{reducer:A,actions:P}=f,N=(0,n.hg)("articlesPage/initArticlesPage",(async(e,a)=>{const{getState:t,dispatch:r}=a;var s;if(s=t(),!s.articlesPage?._inited){const a=e.get("order"),t=e.get("sort"),s=e.get("search"),l=e.get("type");a&&r(P.setOrder(a)),t&&r(P.setSort(t)),s&&r(P.setSearch(s)),l&&r(P.setType(l)),r(P.initState()),r(j({}))}}));var C=t(5443),b=t(1992),M=t(8699),k=t(8979),R=t(3007);const T=(0,n.hg)("articlesPage/fetchNextArticlesPage",(async(e,a)=>{const{getState:t,dispatch:r}=a,s=d(t()),l=p(t());1===l&&r(P.setHasMore(!0)),h(t())&&!s&&(r(P.setPage(l+1)),r(j({})))}));var I=t(2693),E=t(8194),_=t(9323),G=t(6246),O={BIG:"yRwSVBAO",card:"k1ZjryIf",SMALL:"V5k_cvxz",wrap:"ceJuZKjz",no_wrap:"FHQLbMB9",row:"wntX9Urz",wrapper:"sNmnF8Kx",virtualList:"DG9p0YvE"},W=t(5893);const B=e=>{let{articles:a,className:t,target:r,wrap:s=o.im.WRAP,view:l=o.GA.SMALL,error:i,isLoading:c,loadNextPage:n}=e;const d=(0,b.v9)(h),g=l===o.GA.BIG?1:4,u=e=>new Array(e===o.GA.SMALL?4:2).fill(0).map(((a,t)=>(0,W.jsx)(E.s,{view:e},t)));return i?(0,W.jsx)(M.xv,{align:M.PH.CENTER,theme:M.lg.ERROR,size:M.yH.L,title:(0,_.t)("Ошибка загрузки статей")}):c||a.length?(0,W.jsx)("div",{className:O.wrapper,children:(0,W.jsx)(G.OO,{endReached:n,className:(0,R.A)(O.virtualList,{[O[s]]:!0},[t,O[l]]),totalCount:Math.ceil(a?.length/g),itemContent:e=>{const t=[],s=e*g,i=Math.min(s+g,a.length);for(let e=s;e<i;e++)t.push((0,W.jsx)(I.i,{article:a[e],view:l,className:O.card,target:r},a[e].id));return(0,W.jsx)("div",{className:O.row,children:t},e)},components:{Footer:()=>d||c?(0,W.jsx)("div",{className:O.row,children:u(l)}):null}})}):(0,W.jsx)("div",{className:(0,R.A)("",{},[t,O[l]]),children:(0,W.jsx)(M.xv,{size:M.yH.L,title:(0,_.t)("Статьи не найдены")})})},V=e=>{let{className:a,virtual:t=!1}=e;const r=(0,b.v9)(L.selectAll),l=(0,b.v9)(d),c=(0,b.v9)(g),n=(0,b.v9)(u),{t:p}=(0,C.$)(),h=(0,s.T)(),v=(0,i.useCallback)((()=>{h(T())}),[h]);return c?(0,W.jsx)(M.xv,{theme:M.lg.ERROR,text:p("Ошибка подгрузки данных")}):t?(0,W.jsx)("div",{children:(0,W.jsx)(B,{view:n,error:c,isLoading:l,articles:r,loadNextPage:v})}):(0,W.jsx)(k.T,{onScrollEnd:v,className:(0,R.A)("",{},[a]),children:(0,W.jsx)(o.wD,{articles:r,isLoading:l,view:n,className:a})})};var H=t(1554),q=t(11),F={sortWrapper:"pyOjonnp",search:"QkNSez8q",tabs:"JHbc4jKB"};const U=e=>{let{className:a}=e;const{t:t}=(0,C.$)("articles"),r=(0,s.T)(),l=(0,b.v9)(u),c=(0,b.v9)(v),n=(0,b.v9)(m),d=(0,b.v9)(x),g=(0,b.v9)(y),p=(0,i.useCallback)((e=>{r(P.setView(e))}),[r]),h=(0,i.useCallback)((()=>{r(j({replace:!0}))}),[r]),w=((e,a)=>{const t=(0,i.useRef)();return(0,i.useCallback)((function(){for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{e(...r)}),500)}),[e,500])})(h),S=(0,i.useCallback)((e=>{r(P.setOrder(e)),r(P.setPage(1)),h()}),[r,h]),L=(0,i.useCallback)((e=>{r(P.setSearch(e)),r(P.setPage(1)),w()}),[r,w]),f=(0,i.useCallback)((e=>{r(P.setSort(e)),r(P.setPage(1)),h()}),[r,h]),A=(0,i.useCallback)((e=>{r(P.setType(e.value)),r(P.setPage(1)),h()}),[r,h]);return(0,W.jsxs)("div",{className:(0,R.A)(F.articlespagefilters,{},[a]),children:[(0,W.jsxs)("div",{className:F.sortWrapper,children:[(0,W.jsx)(o.xT,{sort:n,order:c,onChangeOrder:S,onChangeSort:f}),(0,W.jsx)(o.Vv,{view:l,onViewClick:p})]}),(0,W.jsx)(H.Z,{className:F.search,children:(0,W.jsx)(q.I,{placeholder:t("Поиск"),value:d,onChange:L})}),(0,W.jsx)(o.XL,{value:g,onChangeTab:A,className:F.tabs})]})};const z={articlesPage:A},$=()=>{const[e]=(0,c.lr)(),a=(0,s.T)();return(0,l.Q)((()=>{a(N(e))})),(0,W.jsx)(r.W,{reducers:z,removeAfterUnmount:!1,children:(0,W.jsxs)("div",{className:"rfWa2r3q",children:[(0,W.jsx)(U,{}),(0,W.jsx)(V,{className:"UsH35LqR",virtual:!0})]})})};var Q=(0,i.memo)($)}}]);